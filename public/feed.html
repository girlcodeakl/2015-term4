<!DOCTYPE html>
<html>
  <head>
    <link href='https://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
    <meta charset="utf-8">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-dateFormat/1.0/jquery.dateFormat.js"></script>
    <title>Idea Feed</title>
    <link rel="stylesheet" href="css/style.css">
  </head>
  <body>
    <div class = "nav-bar">
      <a href="feed.html">Read the feed</a>
      <a href="index.html">Home</a>
    <div class = "idea-box">
      <form method="post" action="/ideas" class="submitform">
        <input class="ideaInput" type="text" name="idea" placeholder="idea goes here">
        <input class="username" type="text" name= "username" placeholder="enter your username here">
        <div class= "note"> </div>
        <input class="submit-button" type="submit" value="enter">
        <center><a class="refresh-button" href="#">Refresh</a></enter>
      </form>
      <div class="posts">
      </div>
    </div>
    <script>

//Hello! This is the start of the JavaScript!

var addIdea = function(idea) {
  var ideaElement = $('<h2>' + idea.text + " " + "<div class='time'>" + $.format.prettyDate(idea.dt) + " by " + idea.username + "</div>" +'<a href="#" class="likeButton">Like</a>'+'</h2>');
  $(".posts").append(ideaElement);
  ideaElement.delegate(".likeButton", "click", function() {
      alert("You liked: " + idea.text + "!");
  });
}

var createFeed = function(data) {
  data.forEach(addIdea);
}
$.get("/ideas", createFeed);


//This is the end of the JavaScript


  var myCoolFunction = function (e) {
    e.preventDefault();
    $(".note").text("Thanks! Your idea was submitted");
    var data = {};
    data.idea = $(".ideaInput").val();
    data.username = $(".username").val();
    $.post( "/ideas" , data );
    data.username = $(".username").val();
  }

  $(".submitform").on("submit", myCoolFunction);

  var refreshIdeas = function(data) {
     $(".posts").empty();
     $.get("/ideas", createFeed);
  }
  $(".refresh-button").on("click", refreshIdeas);
  refreshIdeas();


  </script>
</body>
</html>
